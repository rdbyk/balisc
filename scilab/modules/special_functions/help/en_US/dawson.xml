<?xml version="1.0" encoding="UTF-8"?>
<!--
 * Scilab ( http://www.scilab.org/ ) - This file is part of Scilab
 * Copyright (C) 2008 - INRIA
 * Copyright (C) 2012 - 2016 - Scilab Enterprises
 * Copyright (C) 2020 - Samuel GOUGEON
 *
 * This file is hereby licensed under the terms of the GNU GPL v2.0,
 * pursuant to article 5.3.4 of the CeCILL v.2.1.
 * This file was originally licensed under the terms of the CeCILL v2.1,
 * and continues to be available under such terms.
 * For more information, see the COPYING file which you should have received
 * along with this program.
 *
 -->
<refentry xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"
          xmlns:svg="http://www.w3.org/2000/svg" xmlns:ns4="http://www.w3.org/1999/xhtml"
		  xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:db="http://docbook.org/ns/docbook"
		  xmlns:scilab="http://www.scilab.org" xml:id="dawson" xml:lang="en">
    <refnamediv>
        <refname>dawson</refname>
        <refpurpose>Compute the Dawson (scaled imaginary error) function.</refpurpose>
    </refnamediv>
    <refsynopsisdiv>
        <title>Syntax</title>
        <synopsis>y = dawson(z)</synopsis>
    </refsynopsisdiv>
    <refsection>
        <title>Arguments</title>
        <variablelist>
            <varlistentry>
                <term>z</term>
                <listitem>
                    vector or matrix of real or complex numbers
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>y</term>
                <listitem>
                    vector or matrix of real or complex numbers (of same size than x).
                </listitem>
            </varlistentry>
        </variablelist>
    </refsection>
    <refsection>
        <title>Description</title>
        <para>
            <literal>dawson</literal> computes the scaled imaginary error function, defined as
        </para>
        <para>
            <latex alt="Dawson(z)=exp(-z^2).erfi(z).√π /2">
                \mathrm{Dawson}(z) = \frac{\sqrt{\pi}}{2} e^{-z^2} \mathrm{erfi}(z)
            </latex>
        </para>
    </refsection>
    <refsection>
        <title>Examples</title>
        <programlisting role="example"><![CDATA[
i = %i;
x = [0, 0.01, 1, 100, i, 2*i, 4*i, 8*i,  1-i, 1+i, 2+i, 1e-4+2e-4*i].';
[x, dawson(x), dawson(-x)]
 ]]></programlisting>
    <screen><![CDATA[
--> [x, dawson(x), dawson(-x)]
 ans  =
   0.     + 0.i       0.        + 0.i          0.        + 0.i
   0.01   + 0.i       0.0099993 + 0.i         -0.0099993 + 0.i
   1.     + 0.i       0.5380795 + 0.i         -0.5380795 + 0.i
   100.   + 0.i       0.0050003 + 0.i         -0.0050003 + 0.i
   0.     + i         0.        + 2.0300785i   0.        - 2.0300785i
   0.     + 2.i       0.        + 48.160012i   0.        - 48.160012i
   0.     + 4.i       0.        + 7875110.3i   0.        - 7875110.3i
   0.     + 8.i       0.        + 5.526D+27i   0.        - 5.526D+27i
   1.     - i         0.9903731 + 0.6388731i  -0.9903731 - 0.6388731i
   1.     + i         0.9903731 - 0.6388731i  -0.9903731 + 0.6388731i
   2.     + i         0.1635394 - 0.1531246i  -0.1635394 + 0.1531246i
   0.0001 + 0.0002i   0.0001    + 0.0002i     -0.0001    - 0.0002i
]]></screen>
        <para/>
        <programlisting role="example"><![CDATA[
clf
subplot(1,2,1)
x = logspace(-20,20,100);
y = dawson(x);         // the imaginary part is zero
plot("ll", x, y)
xlabel x fontsize 3
title dawson(x) fontsize 3.5
xgrid(color("grey60"))

subplot(1,2,2)
x = logspace(-7,1,100);
y = imag(dawson(x*%i)); // the real part is zero
plot("ll", x, y)
xlabel x fontsize 3
title imag(dawson(x.i)) fontsize 3.5
xgrid(color("grey60"))
     ]]></programlisting>
        <scilab:image>
            clf
            subplot(1,2,1)
            x = logspace(-20,20,100);
            y = dawson(x);         // the imaginary part is zero
            plot("ll", x, y)
            xlabel x fontsize 3
            title dawson(x) fontsize 3.5
            xgrid(color("grey60"))

            subplot(1,2,2)
            x = logspace(-7,1,100);
            y = imag(dawson(x*%i)); // the real part is zero
            plot("ll", x, y)
            xlabel x fontsize 3
            title imag(dawson(x.i)) fontsize 3.5
            xgrid(color("grey60"))

            gcf().axes_size = [700 380];
        </scilab:image>
    </refsection>
    <refsection>
        <title>Algorithms</title>
        <para>
            This function is based on the <ulink url="http://ab-initio.mit.edu/Faddeeva">Faddeeva package</ulink> library.
        </para>
    </refsection>
    <refsection role="see also">
        <title>See also</title>
        <simplelist type="inline">
            <member>
                <link linkend="erf">erf</link>
            </member>
            <member>
                <link linkend="erfc">erfc</link>
            </member>
            <member>
                <link linkend="calerf">calerf</link>
            </member>
        </simplelist>
    </refsection>
    <refsection>
        <title>History</title>
        <revhistory>
            <revision>
                <revnumber>5.5.0</revnumber>
                <revremark>Function dawson introduced</revremark>
            </revision>
        </revhistory>
    </refsection>
</refentry>
