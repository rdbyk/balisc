warning("off");
A = sparse( [ 2  3  0  0  0;
              3  0  4  0  6; 
              0 -1 -3  2  0; 
              0  0  1  0  0; 
              0  4  2  0  1] );
K1 = condestsp(A);
if norm(K1,39.385965) < 1E-6 then bugmes();quit;end
K1e = norm(A,1)*norm(inv(full(A)),1);
if norm(K1e,39.385965) < 1E-6 then bugmes();quit;end
if K1e <> K1 then bugmes();quit;end
[A] = ReadHBSparse(SCI+"/modules/umfpack/demos/arc130.rua");
K1 = condestsp(A);
if round(K1) <> 10798708075 then bugmes();quit;end
K1e = norm(A,1)*norm(inv(full(A)),1);
if round(K1e) <> 10798708075 then bugmes();quit;end
if round(K1) <> round(K1e) then bugmes();quit;end
Lup = umf_lufact(A);
K1 = condestsp(A,Lup);
if round(K1) <> 10798708075 then bugmes();quit;end
umf_ludel(Lup)
